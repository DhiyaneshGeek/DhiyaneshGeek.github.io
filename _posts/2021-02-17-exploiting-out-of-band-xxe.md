---
layout: post
title: Exploiting Out-Of-Band XXE on Wildfire
date: 2021-02-19
summary: Data Exfiltration using XXE via LOCK HTTP Method
categories: Web Security
tags: [Bugs, Write-Ups, Web Security]
---

Hi Everyone 

In this blog ,i will cover one of the intresting vulnerability **Out-Of-Band XXE via HTTP LOCK Method** that i found during the Red Teaming Engagement in a `Product Based Company` and exploited the vulnerability at **Large Scale**.

<p align="center">
  <img src="/images/xxe/xxe1.png">
</p>

**How it all started ?**

  Under the Red Teaming Activty there are many category such as Cyber Threat Intelligence, Internal Adversary Simulation, External Adversary Simulation, Social Engineering,Deep Web / Dark Web Exposure, OSINT, Phising etc,.
  
<p align="center">
  <img src="/images/xxe/xxe2.png">
</p>
  
  This vulnerability was found during the  External Adversary Simulation Category, where we used to test for Web Application and Network Assets to find Critical Server Side bugs so that we can exfiltrate data and get an inital foothold.
  
**Let's Dive Deep into it!**

* There were hundreds of login pages under the web application pentesting part and credentials that was obtained from Deep / Dark Web Exposure were not working :(

<p align="center">
  <img src="https://media.giphy.com/media/p52j8LBZGNsMJPqqVF/giphy.gif">
</p>

* Found many login pages which was developed by the company to their customers to handle the data between both the parties.

**Step 1:** Intercept the login request using client side proxy like Burp Suite as shown below.

<p align="center">
  <img src="/images/xxe/xxe3.png">
</p>

**Step 2:** Started to check for HTTP Methods enabled in the application by using **OPTIONS**

<p align="center">
  <img src="/images/xxe/xxe4.png">
</p>

From the above image , it can be observed that there is no reaction from the application , got the same response we see from **GET** method.

<p align="center">
  <img src="https://media.giphy.com/media/3og0INyCmHlNylks9O/giphy.gif">
</p>

**Step 3:** When i removed `login.jsp` and supplied a notexisting value (test) it showed up the different HTTP Methods that are allowed in the application.

<p align="center">
  <img src="/images/xxe/xxe5.png">
</p>

<p align="center">
  <img src="https://media.giphy.com/media/jchcqpyTpIki4/giphy.gif">
</p>


